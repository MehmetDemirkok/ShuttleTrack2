# ShuttleTrack - iOS SwiftUI AraÃ§ Takip Sistemi Cursor Rules

## Proje Genel Bilgileri
- **Proje AdÄ±**: ShuttleTrack - HavalimanÄ± Transfer YÃ¶netim Sistemi
- **Platform**: iOS (SwiftUI)
- **Backend**: Firebase (Firestore, Authentication)
- **Mimari**: MVVM (Model-View-ViewModel)
- **Dil**: Swift 5.9+
- **Minimum iOS**: 15.0+

## Proje YapÄ±sÄ± ve Organizasyon

### Dosya Organizasyonu
```
VehicleTrackingAppv2/
â”œâ”€â”€ Models/                    # Veri modelleri
â”‚   â”œâ”€â”€ Company.swift          # Åirket modeli
â”‚   â”œâ”€â”€ Vehicle.swift          # AraÃ§ modeli
â”‚   â”œâ”€â”€ Driver.swift           # ÅofÃ¶r modeli
â”‚   â”œâ”€â”€ Trip.swift             # Transfer iÅŸi modeli
â”‚   â”œâ”€â”€ UserProfile.swift      # KullanÄ±cÄ± profili
â”‚   â””â”€â”€ UserType.swift         # KullanÄ±cÄ± tipi enum
â”œâ”€â”€ Views/                     # SwiftUI gÃ¶rÃ¼nÃ¼mleri
â”‚   â”œâ”€â”€ Components/            # Yeniden kullanÄ±labilir bileÅŸenler
â”‚   â”‚   â”œâ”€â”€ LogoView.swift     # Logo bileÅŸeni
â”‚   â”‚   â””â”€â”€ Theme.swift        # Tema ve stil tanÄ±mlarÄ±
â”‚   â”œâ”€â”€ LoginView.swift        # GiriÅŸ ekranÄ±
â”‚   â”œâ”€â”€ SignUpView.swift       # KayÄ±t ekranÄ±
â”‚   â”œâ”€â”€ DashboardView.swift   # Ana dashboard
â”‚   â”œâ”€â”€ VehicleManagementView.swift  # AraÃ§ yÃ¶netimi
â”‚   â”œâ”€â”€ DriverManagementView.swift  # ÅofÃ¶r yÃ¶netimi
â”‚   â”œâ”€â”€ TripAssignmentView.swift     # Ä°ÅŸ atama
â”‚   â”œâ”€â”€ TrackingView.swift     # AraÃ§ takibi
â”‚   â””â”€â”€ ProfileView.swift     # Profil yÃ¶netimi
â”œâ”€â”€ ViewModels/               # ViewModel sÄ±nÄ±flarÄ±
â”‚   â”œâ”€â”€ AppViewModel.swift     # Ana uygulama view model
â”‚   â”œâ”€â”€ VehicleViewModel.swift # AraÃ§ view model
â”‚   â”œâ”€â”€ DriverViewModel.swift  # ÅofÃ¶r view model
â”‚   â”œâ”€â”€ TripViewModel.swift    # Ä°ÅŸ view model
â”‚   â””â”€â”€ ProfileViewModel.swift # Profil view model
â”œâ”€â”€ Services/                 # Servis sÄ±nÄ±flarÄ±
â”‚   â”œâ”€â”€ StatisticsService.swift # Ä°statistik servisi
â”‚   â””â”€â”€ ExportService.swift    # DÄ±ÅŸa aktarma servisi
â”œâ”€â”€ Assets.xcassets/          # GÃ¶rsel varlÄ±klar
â””â”€â”€ GoogleService-Info.plist  # Firebase yapÄ±landÄ±rmasÄ±
```

## Kodlama StandartlarÄ± ve Kurallar

### 1. SwiftUI ve MVVM Mimarisi
- **MVVM Pattern**: TÃ¼m business logic ViewModel'lerde, UI logic View'larda
- **@Published**: ObservableObject'lerde state deÄŸiÅŸiklikleri iÃ§in
- **@StateObject**: View'larÄ±n sahip olduÄŸu ViewModel'ler iÃ§in
- **@ObservedObject**: Parent'tan gelen ViewModel'ler iÃ§in
- **@EnvironmentObject**: Global state iÃ§in (AppViewModel)

### 2. Firebase Entegrasyonu
- **Firestore**: Veri saklama ve real-time updates
- **Authentication**: KullanÄ±cÄ± giriÅŸi ve yetkilendirme
- **DocumentID**: Firestore document ID'leri iÃ§in
- **Codable**: Model sÄ±nÄ±flarÄ± iÃ§in JSON serialization
- **ListenerRegistration**: Real-time listener'lar iÃ§in cleanup

### 3. Model SÄ±nÄ±flarÄ± KurallarÄ±
```swift
// Model sÄ±nÄ±flarÄ± iÃ§in standart yapÄ±
struct ModelName: Identifiable, Codable {
    @DocumentID var id: String?  // Firestore iÃ§in
    var property1: String
    var property2: Int
    var createdAt: Date
    var updatedAt: Date
    
    // Computed properties
    var displayName: String { ... }
    var statusText: String { ... }
    
    // Custom initializer
    init(...) {
        self.property1 = property1
        self.createdAt = Date()
        self.updatedAt = Date()
    }
}
```

### 4. ViewModel KurallarÄ±
```swift
// ViewModel sÄ±nÄ±flarÄ± iÃ§in standart yapÄ±
@MainActor
class ViewModelName: ObservableObject {
    @Published var data: [Model] = []
    @Published var isLoading = false
    @Published var errorMessage = ""
    
    private let db = Firestore.firestore()
    private var cancellables = Set<AnyCancellable>()
    
    func fetchData(for companyId: String) { ... }
    func addItem(_ item: Model) { ... }
    func updateItem(_ item: Model) { ... }
    func deleteItem(_ item: Model) { ... }
    
    deinit {
        // Cleanup listeners
    }
}
```

### 5. View KurallarÄ±
```swift
// View sÄ±nÄ±flarÄ± iÃ§in standart yapÄ±
struct ViewName: View {
    @EnvironmentObject var appViewModel: AppViewModel
    @StateObject private var viewModel = ViewModelName()
    @State private var localState = ""
    
    var body: some View {
        NavigationView {
            // UI implementation
        }
        .onAppear {
            loadData()
        }
    }
    
    private func loadData() {
        guard let companyId = appViewModel.currentCompany?.id else { return }
        viewModel.fetchData(for: companyId)
    }
}
```

### 6. Tema ve Stil KurallarÄ±
- **ShuttleTrackTheme**: Merkezi tema yÃ¶netimi
- **Custom Modifiers**: `.shuttleTrackTitle()`, `.shuttleTrackCaption()` vb.
- **Button Styles**: `ShuttleTrackButtonStyle` kullanÄ±mÄ±
- **Card Styles**: `ShuttleTrackCard` wrapper'Ä±
- **Color System**: Primary, secondary, status colors

### 7. Firebase Firestore KurallarÄ±
- **Collection Names**: `companies`, `vehicles`, `drivers`, `trips`, `userProfiles`
- **Document Structure**: Her document'te `companyId` field'Ä±
- **Real-time Listeners**: Cleanup iÃ§in `deinit`'te listener'larÄ± kaldÄ±r
- **Error Handling**: Firebase hatalarÄ±nÄ± kullanÄ±cÄ± dostu mesajlara Ã§evir

### 8. Error Handling ve Logging
```swift
// Error handling pattern
if let error = error {
    print("âŒ Error description: \(error.localizedDescription)")
    errorMessage = "KullanÄ±cÄ± dostu hata mesajÄ±"
    return
}

// Success logging
print("âœ… Operation completed successfully")
```

### 9. Async/Await ve Combine
- **@MainActor**: UI gÃ¼ncellemeleri iÃ§in
- **DispatchQueue.main.async**: Firebase callback'leri iÃ§in
- **Combine**: Reactive programming iÃ§in
- **Task**: Modern async/await pattern'i

### 10. Memory Management
- **Weak References**: Closure'larda `[weak self]` kullanÄ±mÄ±
- **Listener Cleanup**: `deinit`'te listener'larÄ± temizle
- **Cancellables**: Combine subscription'larÄ± iÃ§in

## Ã–zel Kurallar ve Notlar

### 1. TÃ¼rkÃ§e Lokalizasyon
- UI metinleri TÃ¼rkÃ§e
- Error mesajlarÄ± TÃ¼rkÃ§e
- Console log'larÄ± TÃ¼rkÃ§e (debug iÃ§in)

### 2. Company-Based Multi-tenancy
- Her veri `companyId` ile filtrelenir
- KullanÄ±cÄ±lar sadece kendi ÅŸirket verilerine eriÅŸebilir
- `appViewModel.currentCompany?.id` kontrolÃ¼ her iÅŸlemde

### 3. Real-time Updates
- Firestore listener'larÄ± kullan
- Dashboard istatistikleri real-time
- AraÃ§ konumlarÄ± real-time

### 4. Form Validation
- Email format kontrolÃ¼
- Required field kontrolÃ¼
- Date validation (sigorta, muayene tarihleri)

### 5. Performance Optimizations
- LazyVGrid kullanÄ±mÄ± bÃ¼yÃ¼k listeler iÃ§in
- Image caching
- Pagination bÃ¼yÃ¼k veri setleri iÃ§in

## Yeni Ã–zellik Ekleme KurallarÄ±

### 1. Yeni Model Ekleme
1. `Models/` klasÃ¶rÃ¼ne ekle
2. `Identifiable, Codable` implement et
3. `@DocumentID var id: String?` ekle
4. `companyId` field'Ä± ekle
5. Computed properties ekle

### 2. Yeni View Ekleme
1. `Views/` klasÃ¶rÃ¼ne ekle
2. `@EnvironmentObject var appViewModel: AppViewModel` ekle
3. `@StateObject private var viewModel` ekle
4. `onAppear` ile data loading
5. Error handling ekle

### 3. Yeni ViewModel Ekleme
1. `ViewModels/` klasÃ¶rÃ¼ne ekle
2. `@MainActor class` olarak tanÄ±mla
3. `ObservableObject` implement et
4. Firebase operations ekle
5. Error handling ve loading states

### 4. Yeni Service Ekleme
1. `Services/` klasÃ¶rÃ¼ne ekle
2. `@MainActor class` olarak tanÄ±mla
3. `ObservableObject` implement et
4. Firebase operations ekle
5. Real-time listener'lar iÃ§in cleanup

## Debugging ve Development

### 1. Console Logging
- `print("âœ… Success message")` - BaÅŸarÄ±lÄ± iÅŸlemler
- `print("âŒ Error message")` - Hata durumlarÄ±
- `print("âš ï¸ Warning message")` - UyarÄ±lar
- `print("ğŸ“Š Data message")` - Veri iÅŸlemleri

### 2. Firebase Debugging
- Firestore rules test et
- Authentication flow kontrol et
- Real-time listener'larÄ± kontrol et
- Network requests izle

### 3. UI Debugging
- SwiftUI preview'larÄ± kullan
- Device simulator'da test et
- Dark/Light mode test et
- Accessibility test et

## GÃ¼venlik ve Best Practices

### 1. Firebase Security
- Firestore security rules
- Authentication state kontrolÃ¼
- Company-based data isolation

### 2. Data Validation
- Input validation
- Date validation
- Email format validation
- Phone number validation

### 3. Error Recovery
- Network error handling
- Firebase error handling
- User-friendly error messages
- Retry mechanisms

Bu kurallar ShuttleTrack projesinin mevcut yapÄ±sÄ±na uygun olarak hazÄ±rlanmÄ±ÅŸtÄ±r ve geliÅŸtirme sÃ¼recinde tutarlÄ±lÄ±k saÄŸlamak iÃ§in kullanÄ±lmalÄ±dÄ±r.
